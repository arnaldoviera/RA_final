cme <- SCE/(n-p) #igual al cuadrado de la residual SE
#R2 ajustado
r2aj <- 1 - ((n-1)/(n-p)) * (1-summary(m)$r.squared)
#summary(m)$adj.r.squared
#yi <- iris$Petal.Length
#1 - (deviance(m) / (n-p)) / ((sum((yi - mean(yi))^2))/(n-1))
#PRESS
estpress <- sum((residuals(m)/(1-hatvalues(m)))^2) #qpcR::PRESS(m)
#Mallows CP
mcp <- SCE/(deviance(maxi)/(n-length(coefficients(maxi)))) + 2*p - n
#olsrr::ols_mallows_cp(m, maxi)
#AKAIKE
akaike <- n * log(SCE/n) + 2*p #extractAIC(m)[2]
#BIC
schwarz <- n * log(SCE/n) + p*log(n) #extractAIC(m, k = log(n))[2]
tibble(CME = cme, R2Aj = r2aj, PRESS = estpress, Cp = mcp, AIC = akaike, BIC = schwarz)
}
map_dfr(list(m1, m2, m3, m4, m5, m6, m7, m8), criterios, maxi = m8)
data(data_dummy)
stepAIC(
object = lm(pje ~ 1, data = data_dummy), #punto de partida
scope = list(upper = lm(pje ~ ., data = data_dummy)), #maximo modelo posible
direction = "forward", #mÃÂÃÂ©todo de selecciÃÂÃÂ³n
trace = FALSE #para no imprimir resultados parciales
)
View(data_dummy)
?step
data(data_dummy)
as.data.frame(data_dummy)
data(data_dummy)
stepAIC(
object = lm(pje ~ 1, data = data_dummy), #punto de partida
scope = list(upper = lm(pje ~ ., data = data_dummy)), #maximo modelo posible
direction = "forward", #mÃÂÃÂ©todo de selecciÃÂÃÂ³n
trace = FALSE #para no imprimir resultados parciales
)
mod_forward <- lm(formula = pje ~ pobreza + Este + densidad + mujeres + veteranos +
ahorros + data_dummy_4 + ingpc, data = data_dummy)
summary(mod_forward)
stepAIC(
object = lm(medv ~ ., data = Boston), #punto de partida
scope = list(upper = lm(medv ~ 1, data = Boston)), #máximo modelo posible
direction = "backward", #método de selección
trace = F #para no imprimir resultados parciales
)
stepAIC(
object = lm(medv ~ ., data = Boston), #punto de partida
scope = list(upper = lm(medv ~ 1, data = data_dummy)), #máximo modelo posible
direction = "backward", #método de selección
trace = F #para no imprimir resultados parciales
)
stepAIC(
object = lm(pje ~ ., data = data_dummy), #punto de partida
scope = list(upper = lm(pje ~ 1, data = data_dummy)), #máximo modelo posible
direction = "backward", #método de selección
trace = F #para no imprimir resultados parciales
)
lm(formula = pje ~ ahorros + ingpc + pobreza + veteranos + mujeres +
densidad + Este + data_dummy_4, data = data_dummy)
lm(formula = pje ~ ahorros + ingpc + pobreza + veteranos + mujeres +
densidad + Este + data_dummy_4, data = data_dummy)
mod_backward  <- lm(formula = pje ~ ahorros + ingpc + pobreza + veteranos + mujeres +
densidad + Este + data_dummy_4, data = data_dummy)
summary(mod_forward)
mod_mejorsub <- regsubsets(
x = pje ~ . ,
data = data_dummy
)
resumen <- summary(mod_mejorsub)
resumen
resumen <- summary(mod_mejorsub)
resumen
## Paso estados a datos dummy
data_dummy_largo <- data
data_dummy<- cbind(data,clasif_estados) ##se pega bien
data_dummy$Regiones <- as.factor(data_dummy$Regiones)
data_dummy$Este <- as.factor(data_dummy$Este)
data_dummy_largo <- cbind(data, data_dummy(data$estado, sep ="_"))
data_dummy_largo <- cbind(data, data_dummy_largo(data_dummy_largo$estado, sep ="_"))
data_dummy_largo <- cbind(data, dummy(data_d$estado, sep ="_"))
data_dummy_largo <- cbind(data, dummy(data_dummy_largo$estado, sep ="_"))
View(data_dummy_largo)
data_dummy_largo$condado <- NULL
data_dummy_largo$estado <- NULL
data_dummy_largo$data_AL <- NULL
stepAIC(
object = lm(pje ~ ., data = data_dummy_largo), #punto de partida
scope = list(upper = lm(pje ~ 1, data = data_dummy_largo)), #máximo modelo posible
direction = "backward", #método de selección
trace = F #para no imprimir resultados parciales
)
mod_backward2  <- lm(formula = pje ~ ahorros + ingpc + pobreza + veteranos + mujeres +
densidad + crimen + data_AR + data_AZ + data_CO + data_CT +
data_DC + data_DE + data_FL + data_IA + data_ID + data_IL +
data_IN + data_KS + data_LA + data_MA + data_ME + data_MN +
data_MS + data_MT + data_NC + data_ND + data_NE + data_NH +
data_NM + data_NV + data_NY + data_OH + data_OK + data_OR +
data_PA + data_RI + data_SD + data_TN + data_TX + data_UT +
data_VT + data_WI + data_WY, data = data_dummy_largo)
summary(mod_forward2)
summary(mod_backward)
summary(mod_backward2)
mod_mejorsub <- regsubsets(
x = pje ~ . ,
data = data_dummy_largo
)
mod_mejorsub <- regsubsets(
x = pje ~ . ,
data = data_dummy_largo
)
mod_mejorsub2 <- regsubsets(
x = pje ~ . ,
data = data_dummy_largo
)
data_dummy_largo <- data
data_dummy<- cbind(data,clasif_estados) ##se pega bien
data_dummy_largo <- data
data_dummy_largo <- data
data_dummy_largo<- cbind(data,clasif_estados) ##se pega bien
data_dummy_largo$Regiones <- as.factor(data_dummy_largo$Regiones)
data_dummy_largo$Este <- as.factor(data_dummy_largo$Este)
data_dummy <- cbind(data_dummy, dummy(data_dummy$Regiones, sep ="_"))
data_dummy_largo <- cbind(data_dummy, dummy(data_dummy$Regiones, sep ="_"))
data_dummy_largo <- cbind(data_dummy_largo, dummy(data_dummy_largo$Regiones, sep ="_"))
data_dummy_largo <- cbind(data, dummy(data_dummy_largo$estado, sep ="_"))
data_dummy_largo <- cbind(data_dummy_largo, dummy(data_dummy_largo$Regiones, sep ="_"))
data_dummy_largo$condado <- NULL
data_dummy_largo$estado <- NULL
data_dummy_largo$data_AL <- NULL
View(data_dummy_largo)
data_dummy_largo <- cbind(data, dummy(data_dummy_largo$Regiones, sep ="_"))
data_dummy_largo <- cbind(datareg, dummy(data_dummy_largo$Regiones, sep ="_"))
data_dummy_largo <- cbind(data_du, dummy(data_dummy_largo$Regiones, sep ="_"))
data_dummy_largo <- data
data_dummy_largo<- cbind(data,clasif_estados) ##se pega bien
data_dummy_largo$Regiones <- as.factor(data_dummy_largo$Regiones)
data_dummy_largo$Este <- as.factor(data_dummy_largo$Este)
data_dummy_largo <- cbind(data_dummy_largo, dummy(data_dummy_largo$Regiones, sep ="_"))
data_dummy_largo <- cbind(data_dummy_largo, dummy(data_dummy_largo$estado, sep ="_"))
data_dummy_largo$condado <- NULL
data_dummy_largo$estado <- NULL
data_dummy_largo$data_AL <- NULL
data_dummy_largo$estado <- NULL
data_dummy_largo$estado <- NULL
data_dummy_largo$data_dummy_largo_AL <- NULL
data_dummy_largo$data_dummy_largo_AL <- NULL
stepAIC(
object = lm(pje ~ ., data = data_dummy_largo), #punto de partida
scope = list(upper = lm(pje ~ 1, data = data_dummy_largo)), #máximo modelo posible
direction = "backward", #método de selección
trace = F #para no imprimir resultados parciales
)
View(data_dummy_largo)
hola <- lm(formula = pje ~ ahorros + ingpc + pobreza + veteranos + mujeres +
densidad + crimen + `Descrip Estado`, data = data_dummy_largo)
summary(hola)
View(data_dummy_largo)
data_dummy_largo$`Descrip Estado`<- NULL
stepAIC(
object = lm(pje ~ ., data = data_dummy_largo), #punto de partida
scope = list(upper = lm(pje ~ 1, data = data_dummy_largo)), #máximo modelo posible
direction = "backward", #método de selección
trace = F #para no imprimir resultados parciales
)
data_dummy_largo <- data
data_dummy_largo<- cbind(data,clasif_estados) ##se pega bien
data_dummy_largo$Regiones <- as.factor(data_dummy_largo$Regiones)
data_dummy_largo$Este <- as.factor(data_dummy_largo$Este)
data_dummy_largo <- cbind(ddlReg, dummy(data_dummy_largo$Regiones, sep ="_"))
data_dummy_largo <- cbind(ddlestado, dummy(data_dummy_largo$estado, sep ="_"))
data_dummy_largo$condado <- NULL
data_dummy_largo$estado <- NULL
data_dummy_largo$estado <- NULL
data_dummy_largo$data_dummy_largo_AL <- NULL
data_dummy_largo$data_dummy_largo_AL <- NULL
data_dummy_largo$`Descrip Estado`<- NULL
stepAIC(
object = lm(pje ~ ., data = data_dummy_largo), #punto de partida
scope = list(upper = lm(pje ~ 1, data = data_dummy_largo)), #máximo modelo posible
direction = "backward", #método de selección
trace = F #para no imprimir resultados parciales
)
data_dummy_largo <- data
data_dummy_largo<- cbind(data,clasif_estados) ##se pega bien
data_dummy_largo$Regiones <- as.factor(data_dummy_largo$Regiones)
data_dummy_largo$Este <- as.factor(data_dummy_largo$Este)
data_dummy_largo <- cbind(ddlReg, dummy(data_dummy_largo$Regiones, sep ="_"))
data_dummy_largo <- cbind(ddlestado, dummy(data_dummy_largo$estado, sep ="_"))
data_dummy_largo <- data
data_dummy_largo<- cbind(data,clasif_estados) ##se pega bien
data_dummy_largo$Regiones <- as.factor(data_dummy_largo$Regiones)
data_dummy_largo$Este <- as.factor(data_dummy_largo$Este)
data_dummy_largo <- cbind(ddlReg, dummy(data_dummy_largo$Regiones, sep ="_"))
ddl <- cbind(data,clasif_estados) ##se pega bien
ddl <- cbind(data,clasif_estados) ##se pega bien
ddl$Regiones <- as.factor(ddl$Regiones)
ddl$Este <- as.factor(ddl$Este)
ddl <- cbind(ddlReg, dummy(ddl$Regiones, sep ="_"))
ddl <- cbind(ddl, dummy(ddl$Regiones, sep ="_"))
ddl <- cbind(ddl, dummy(ddl$estado, sep ="_"))
ddl$condado <- NULL
ddl$estado <- NULL
ddl$estado <- NULL
ddl$data_dummy_largo_AL <- NULL
ddl$data_dummy_largo_AL <- NULL
ddl$estado <- NULL
ddl$data_dummy_largo_AL <- NULL
ddl$data_dummy_largo_AL <- NULL
ddl$ddl_1 - NULL
ddl$ddl_1 <- NULL
ddl$ddl_AL <- NULL
ddl$`Descrip Estado`<- NULL
View(ddl)
stepAIC(
object = lm(pje ~ ., data = ddl), #punto de partida
scope = list(upper = lm(pje ~ 1, data = ddl)), #máximo modelo posible
direction = "backward", #método de selección
trace = F #para no imprimir resultados parciales
)
mod_backward2  <-  lm(formula = pje ~ ahorros + ingpc + pobreza + veteranos + mujeres +
densidad + crimen + Regiones + Este + ddl_AR + ddl_CA + ddl_CO +
ddl_DC + ddl_DE + ddl_FL + ddl_IA + ddl_ID + ddl_IL + ddl_IN +
ddl_KS + ddl_LA + ddl_MA + ddl_ME + ddl_MI + ddl_MN + ddl_MO +
ddl_MS + ddl_NC + ddl_NE + ddl_NJ + ddl_NM + ddl_NY + ddl_OH +
ddl_OR + ddl_PA + ddl_TN + ddl_UT + ddl_WA, data = ddl)
summary(mod_backward2)
rm( list=ls() )
gc()
library(readr)
library(dplyr)
library(ggplot2)
library(tidyr)
library(alr4)
library(ISLR)
library(GGally)
library(qpcR)
library(UsingR)
library(data.table)
library(funModeling)
library(scales)
library(dummies)
library(kableExtra)
library(psych)
library(GGally)
library(qpcR)
library(UsingR)
library(data.table)
library(funModeling)
library(scales)
library(dummies)
library(kableExtra)
library(psych)
library(glmnet)
library(dplyr)
library(leaps)
library(UsingR)
library(tidyverse)
library(MASS)
library(glmnet)
library(leaps)
library(purrr)
library(corrplot)
#Cargamos el dataset
#dos aca cada uno pone si ingreso de la data
#Cadauno usa su directorio
#setwd("C:/Users/vieraa/Documents/GitHub/RA_final" )
#setwd("C:/Users/quintej/Desktop/MCD/Regresion Avanzada/" )   #establezco la carpeta donde voy a trabajar
#setwd("C:/Users/jgiberti/Documents/Univ. Austral - Maestria en Ciencias de Datos/10. Regresion Avanzada/TP/" )
setwd("C:/Users/isant/OneDrive/Desktop/MCD/Regresión Avanzada/TP Final")
data <- fread("clinton.txt")
#yo en mi PC le cambie la columna este/oeste por este solo. Si es 1, es del este si es 0 es del oeste
clasif_estados <- read_delim("clasif_estados.csv",
";", escape_double = FALSE, trim_ws = TRUE)
data1 <- dplyr::select(data, pje:crimen)
grafico1<-ggpairs(data1, title="correlogram with ggpairs()")
grafico1
grafico2<-ggcorr(data1, nbreaks = 4, palette = "RdGy", label = TRUE, label_size = 3, label_color = "white")
grafico2
multi.hist(x = data1, dcol = c("blue", "red"), dlty = c("dotted", "solid"),
main = NULL)
#Visualizo que relacion tiene cada variable con la respuesta
mfrow = c(2, 2)
data1 %>%
ggplot(aes(edad, pje)) +
geom_point() +
scale_y_continuous(labels = scales::dollar) +
labs(x = "Edad", y = "PJE")
data1 %>%
ggplot(aes(ahorros, pje)) +
geom_point() +
scale_y_continuous(labels = scales::dollar) +
labs(x = "Ahorros", y = "PJE")
data1 %>%
ggplot(aes(ingpc, pje)) +
geom_point() +
scale_y_continuous(labels = scales::dollar) +
labs(x = "ingpc", y = "PJE")
data1 %>%
ggplot(aes(pobreza, pje)) +
geom_point() +
scale_y_continuous(labels = scales::dollar) +
labs(x = "Pobreza", y = "PJE")
data1 %>%
ggplot(aes(veteranos, pje)) +
geom_point() +
scale_y_continuous(labels = scales::dollar) +
labs(x = "Veteranos", y = "PJE")
data1 %>%
ggplot(aes(mujeres, pje)) +
geom_point() +
scale_y_continuous(labels = scales::dollar) +
labs(x = "Mujeres", y = "PJE")
data1 %>%
ggplot(aes(densidad, pje)) +
geom_point() +
scale_y_continuous(labels = scales::dollar) +
labs(x = "Densidad", y = "PJE")
data1 %>%
ggplot(aes(ancianos, pje)) +
geom_point() +
scale_y_continuous(labels = scales::dollar) +
labs(x = "Ancianos", y = "PJE")
data1 %>%
ggplot(aes(crimen, pje)) +
geom_point() +
scale_y_continuous(labels = scales::dollar) +
labs(x = "Crimen", y = "PJE")
mfrow = c(1, 1)
## Paso estados a datos dummy
data_dummy <- data
data_dummy<- cbind(data,clasif_estados) ##se pega bien
data_dummy$Regiones <- as.factor(data_dummy$Regiones)
data_dummy$Este <- as.factor(data_dummy$Este)
data_dummy <- cbind(data_dummy, dummy(data_dummy$Regiones, sep ="_"))
##Borro lo que no necesito:
data_dummy$estado <- NULL
data_dummy$estado <- NULL
data_dummy$condado <- NULL
data_dummy$`Descrip Estado` <- NULL
data_dummy$Regiones <- NULL
data_dummy$data_dummy_1 <- NULL #a la mierda regiÃ³n 1
mod_1<- lm(pje ~ edad+pobreza + densidad + mujeres + ahorros + veteranos + ancianos + ingpc + crimen +data_dummy_2 + data_dummy_3 + data_dummy_4, data = data_dummy)
data_dummy$data_dummy_1 <- NULL #a la mierda regiÃ³n 1
mod_1<- lm(pje ~ edad+pobreza + densidad + mujeres + ahorros + veteranos + ancianos + ingpc + crimen +data_dummy_2 + data_dummy_3 + data_dummy_4, data = data_dummy)
summary(mod_1)
mod_2<- lm(pje ~ edad+pobreza + densidad + mujeres + ahorros + veteranos + ancianos + ingpc + crimen +Este, data = data_dummy)
summary(mod_2)
ddl <- cbind(data,clasif_estados) ##se pega bien
ddl$Regiones <- as.factor(ddl$Regiones)
ddl$Este <- as.factor(ddl$Este)
ddl <- cbind(ddl, dummy(ddl$Regiones, sep ="_"))
ddl <- cbind(ddl, dummy(ddl$estado, sep ="_"))
ddl$condado <- NULL
ddl$estado <- NULL
ddl$estado <- NULL
ddl$ddl_1 <- NULL
ddl$ddl_AL <- NULL
ddl$`Descrip Estado`<- NULL
stepAIC(
object = lm(pje ~ ., data = ddl), #punto de partida
scope = list(upper = lm(pje ~ 1, data = ddl)), #máximo modelo posible
direction = "backward", #método de selección
trace = F #para no imprimir resultados parciales
)
mod_9  <-  lm(formula = pje ~ ahorros + ingpc + pobreza + veteranos + mujeres +
densidad + crimen + Regiones + Este + ddl_AR + ddl_CA + ddl_CO +
ddl_DC + ddl_DE + ddl_FL + ddl_IA + ddl_ID + ddl_IL + ddl_IN +
ddl_KS + ddl_LA + ddl_MA + ddl_ME + ddl_MI + ddl_MN + ddl_MO +
ddl_MS + ddl_NC + ddl_NE + ddl_NJ + ddl_NM + ddl_NY + ddl_OH +
ddl_OR + ddl_PA + ddl_TN + ddl_UT + ddl_WA, data = ddl)
summary(mod_9)
plot(mod_9)
densidad + crimen + Regiones + Este + ddl_AR + ddl_CA + ddl_CO +
ddl_DC + ddl_DE + ddl_FL + ddl_IA + ddl_ID + ddl_IL + ddl_IN +
ddl_KS + ddl_LA + ddl_MA + ddl_ME + ddl_MI + ddl_MN + ddl_MO +
ddl_MS + ddl_NC + ddl_NE + ddl_NJ + ddl_NM + ddl_NY + ddl_OH +
ddl_OR + ddl_PA + ddl_TN + ddl_UT + ddl_WA, data = ddl1)
mod_10  <-  lm(formula = pje ~ ahorros + ingpc + pobreza + veteranos + mujeres +
densidad + crimen + Regiones + Este + ddl_AR + ddl_CA + ddl_CO +
ddl_DC + ddl_DE + ddl_FL + ddl_IA + ddl_ID + ddl_IL + ddl_IN +
ddl_KS + ddl_LA + ddl_MA + ddl_ME + ddl_MI + ddl_MN + ddl_MO +
ddl_MS + ddl_NC + ddl_NE + ddl_NJ + ddl_NM + ddl_NY + ddl_OH +
ddl_OR + ddl_PA + ddl_TN + ddl_UT + ddl_WA, data = ddl1)
ddl1 <- slice(ddl, -excluir)
excluir <- c(1602, 2184, 948,1297, 1871,1765,2356)
ddl1 <- slice(ddl, -excluir)
mod_10  <-  lm(formula = pje ~ ahorros + ingpc + pobreza + veteranos + mujeres +
densidad + crimen + Regiones + Este + ddl_AR + ddl_CA + ddl_CO +
ddl_DC + ddl_DE + ddl_FL + ddl_IA + ddl_ID + ddl_IL + ddl_IN +
ddl_KS + ddl_LA + ddl_MA + ddl_ME + ddl_MI + ddl_MN + ddl_MO +
ddl_MS + ddl_NC + ddl_NE + ddl_NJ + ddl_NM + ddl_NY + ddl_OH +
ddl_OR + ddl_PA + ddl_TN + ddl_UT + ddl_WA, data = ddl1)
summary(mod_10)
plot(mod_10)
ddl_MS + ddl_NE + ddl_OH + ddl_PA + ddl_TN + ddl_UT + ddl_WA, data = ddl)
mod_11  <-  lm(formula = pje ~ ahorros + ingpc + pobreza + veteranos + mujeres +
densidad + Regiones + Este + ddl_AR + ddl_CA +
ddl_DC + ddl_FL + ddl_IA + ddl_ID + ddl_IL + ddl_IN +
ddl_KS + ddl_MA + ddl_MN + ddl_MO +
ddl_MS + ddl_NE + ddl_OH + ddl_PA + ddl_TN + ddl_UT + ddl_WA, data = ddl)
summary(mod_11)
anova(mod_11)
mod_12 <-  lm(formula = pje ~ ahorros + ingpc + pobreza + veteranos + mujeres +
densidad + Regiones + Este + ddl_AR + ddl_CA +
ddl_DC + ddl_FL + ddl_IA + ddl_ID + ddl_IL + ddl_IN +
ddl_KS + ddl_MA + ddl_MN + ddl_MO +
ddl_MS + ddl_NE + ddl_OH + ddl_TN + ddl_UT + ddl_WA, data = ddl)
summary(mod_12)
mod_13 <-  lm(formula = pje ~ ahorros + ingpc + pobreza + veteranos + mujeres +
densidad + Regiones + ddl_AR + ddl_CA +
ddl_DC + ddl_FL + ddl_IA + ddl_ID + ddl_IL + ddl_IN +
ddl_KS + ddl_MA + ddl_MN + ddl_MO +
ddl_MS + ddl_NE + ddl_OH + ddl_TN + ddl_UT + ddl_WA, data = ddl)
summary(mod_13)
mod_14 <-  lm(formula = pje ~ ahorros + ingpc + pobreza + veteranos + mujeres +
densidad + Este + ddl_AR + ddl_CA +
ddl_DC + ddl_FL + ddl_IA + ddl_ID + ddl_IL + ddl_IN +
ddl_KS + ddl_MA + ddl_MN + ddl_MO +
ddl_MS + ddl_NE + ddl_OH + ddl_TN + ddl_UT + ddl_WA, data = ddl)
summary(mod_14)
plot(mod_14)
ddl_DC + ddl_FL + ddl_IA + ddl_ID + ddl_IL + ddl_IN +
ddl_KS + ddl_MA + ddl_MN + ddl_MO +
ddl_MS + ddl_NE + ddl_OH + ddl_TN + ddl_UT + ddl_WA, data = ddl2)
mod_15 <-  lm(formula = pje ~ ahorros + ingpc + pobreza + veteranos + mujeres +
densidad + Este + ddl_AR + ddl_CA +
ddl_DC + ddl_FL + ddl_IA + ddl_ID + ddl_IL + ddl_IN +
ddl_KS + ddl_MA + ddl_MN + ddl_MO +
ddl_MS + ddl_NE + ddl_OH + ddl_TN + ddl_UT + ddl_WA, data = ddl2)
excluir <- c(1602, 948)
ddl2 <- slice(ddl, -excluir)
mod_15 <-  lm(formula = pje ~ ahorros + ingpc + pobreza + veteranos + mujeres +
densidad + Este + ddl_AR + ddl_CA +
ddl_DC + ddl_FL + ddl_IA + ddl_ID + ddl_IL + ddl_IN +
ddl_KS + ddl_MA + ddl_MN + ddl_MO +
ddl_MS + ddl_NE + ddl_OH + ddl_TN + ddl_UT + ddl_WA, data = ddl2)
summary(mod_15)
ddl <- cbind(data,clasif_estados) ##se pega bien
ddl$Regiones <- as.factor(ddl$Regiones)
ddl$Este <- as.factor(ddl$Este)
ddl <- cbind(ddl, dummy(ddl$Regiones, sep ="_"))
ddl <- cbind(ddl, dummy(ddl$estado, sep ="_"))
ddl$condado <- NULL
ddl$estado <- NULL
ddl$estado <- NULL
ddl$ddl_1 <- NULL
ddl$ddl_AL <- NULL
ddl$`Descrip Estado`<- NULL
ddl$Este <- NULL
ddl$Regiones <- NULL
stepAIC(
object = lm(pje ~ ., data = ddl), #punto de partida
scope = list(upper = lm(pje ~ 1, data = ddl)), #máximo modelo posible
direction = "backward", #método de selección
trace = F #para no imprimir resultados parciales
)
mod_9  <-  lm(formula = pje ~ ahorros + ingpc + pobreza + veteranos + mujeres +
densidad + crimen + Regiones + Este + ddl_AR + ddl_CA + ddl_CO +
ddl_DC + ddl_DE + ddl_FL + ddl_IA + ddl_ID + ddl_IL + ddl_IN +
ddl_KS + ddl_LA + ddl_MA + ddl_ME + ddl_MI + ddl_MN + ddl_MO +
ddl_MS + ddl_NC + ddl_NE + ddl_NJ + ddl_NM + ddl_NY + ddl_OH +
ddl_OR + ddl_PA + ddl_TN + ddl_UT + ddl_WA, data = ddl)
summary(mod_9)
mod_9  <-  lm(formula = pje ~ ahorros + ingpc + pobreza + veteranos + mujeres +
densidad + crimen + Regiones + Este + ddl_AR + ddl_CA + ddl_CO +
ddl_DC + ddl_DE + ddl_FL + ddl_IA + ddl_ID + ddl_IL + ddl_IN +
ddl_KS + ddl_LA + ddl_MA + ddl_ME + ddl_MI + ddl_MN + ddl_MO +
ddl_MS + ddl_NC + ddl_NE + ddl_NJ + ddl_NM + ddl_NY + ddl_OH +
ddl_OR + ddl_PA + ddl_TN + ddl_UT + ddl_WA, data = ddl)
stepAIC(
object = lm(pje ~ ., data = ddl), #punto de partida
scope = list(upper = lm(pje ~ 1, data = ddl)), #máximo modelo posible
direction = "backward", #método de selección
trace = F #para no imprimir resultados parciales
)
stepAIC(
object = lm(pje ~ ., data = ddl), #punto de partida
scope = list(upper = lm(pje ~ 1, data = ddl)), #máximo modelo posible
direction = "backward", #método de selección
trace = F #para no imprimir resultados parciales
)
mod_9  <-  lm(formula = pje ~ ahorros + ingpc + pobreza + veteranos + mujeres +
densidad + crimen + ddl_2 + ddl_3 + ddl_4 + ddl_AR + ddl_CA +
ddl_CO + ddl_DC + ddl_DE + ddl_FL + ddl_ID + ddl_IL + ddl_IN +
ddl_KS + ddl_LA + ddl_MA + ddl_ME + ddl_MI + ddl_MO + ddl_MS +
ddl_NC + ddl_ND + ddl_NE + ddl_NJ + ddl_NM + ddl_NY + ddl_OH +
ddl_OK + ddl_OR + ddl_PA + ddl_SD + ddl_TN + ddl_TX + ddl_UT +
ddl_WA, data = ddl)
summary(mod_9)
plot(mod_9)
densidad + crimen + Regiones + Este + ddl_AR + ddl_CA + ddl_CO +
ddl_DC + ddl_DE + ddl_FL + ddl_IA + ddl_ID + ddl_IL + ddl_IN +
ddl_KS + ddl_LA + ddl_MA + ddl_ME + ddl_MI + ddl_MN + ddl_MO +
ddl_MS + ddl_NC + ddl_NE + ddl_NJ + ddl_NM + ddl_NY + ddl_OH +
ddl_OR + ddl_PA + ddl_TN + ddl_UT + ddl_WA, data = ddl1)
excluir <- c(1602, 2184, 948,1297, 1871,1765,2356)
ddl1 <- slice(ddl, -excluir)
mod_10  <-  lm(formula = pje ~ ahorros + ingpc + pobreza + veteranos + mujeres +
densidad + crimen + Regiones + Este + ddl_AR + ddl_CA + ddl_CO +
ddl_DC + ddl_DE + ddl_FL + ddl_IA + ddl_ID + ddl_IL + ddl_IN +
ddl_KS + ddl_LA + ddl_MA + ddl_ME + ddl_MI + ddl_MN + ddl_MO +
ddl_MS + ddl_NC + ddl_NE + ddl_NJ + ddl_NM + ddl_NY + ddl_OH +
ddl_OR + ddl_PA + ddl_TN + ddl_UT + ddl_WA, data = ddl1)
mod_10  <-  lm(formula = pje ~ ahorros + ingpc + pobreza + veteranos + mujeres +
densidad + crimen + ddl_AR + ddl_CA + ddl_CO +
ddl_DC + ddl_DE + ddl_FL + ddl_IA + ddl_ID + ddl_IL + ddl_IN +
ddl_KS + ddl_LA + ddl_MA + ddl_ME + ddl_MI + ddl_MN + ddl_MO +
ddl_MS + ddl_NC + ddl_NE + ddl_NJ + ddl_NM + ddl_NY + ddl_OH +
ddl_OR + ddl_PA + ddl_TN + ddl_UT + ddl_WA, data = ddl1)
summary(mod_10)
plot(mod_10)
ddl_MS + ddl_NE + ddl_OH + ddl_PA + ddl_TN + ddl_UT + ddl_WA, data = ddl)
